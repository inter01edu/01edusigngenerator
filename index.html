<!doctype html>
<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">

    <style>
      /* Police globale */
      html, body, table, td, a, div {
        font-family: Gotham, "Gotham", Arial, sans-serif;
      }

      /* Logo principal */
      .logo01edu img:first-child {
        width: 100px;
        max-width: 100px;
        height: auto;
        margin-bottom: 0px;
        display: inline-block;
      }

      .logo01edu {
        padding-right: 6px;
        text-align: center;
      }

      /* Logos sociaux */
      .social img {
        width: 22px;
        height: 22px;
        min-width: 22px;
        min-height: 22px;
        object-fit: contain;
        display: block;
      }

      .social table {
        width: auto !important;
        margin: 0 auto !important;
        border-collapse: collapse;
      }

      .social td {
        padding: 0 2px;
        width: 22px;
      }

      .social a,
      .social img {
        display: block;
      }

      /* Espacement vertical du texte */
      .sig-text td {
        line-height: 2.35;
      }
    </style>
  </head>

  <body>
    <script>
      function slugify(str) {
        return (str || "")
          .toLowerCase()
          .trim()
          .replace(/\s+/g, "-")
          .replace(/[^a-z0-9-]/g, "");
      }

      fetch("https://opensheet.elk.sh/1maVoCpxQUmelT_wpZzTZERPzW4y20zGeoLtQuxbFvXQ/1")
        .then(r => r.json())
        .then(users =>
          users.filter(Boolean).map(({ firstname, lastname, title, mobile }) => {
            const slug = slugify(`${firstname} ${lastname}`) || `user-${Math.random().toString(16).slice(2)}`;

            return [
              `<div id="${slug}" style="display: flex; flex-direction: row; margin: 10px 0; user-select: none">`,
                '<div style="background: #eee; flex-grow: 1"></div>',
                `<a style="text-decoration: none; color: grey" href="#${slug}">ðŸ”—</a>`,
              '</div>',

              '<table cellpadding="0" cellspacing="0" border="0" style="width: 100%; border-collapse: collapse; font-family: sans-serif;">',
                '<tr>',

                  '<td style="width: 100px;">',
                    '<table cellpadding="0" cellspacing="0" border="0" style="border-collapse: collapse; text-align: center;">',

                      '<tr>',
                        '<td class="logo01edu">',
                          '<img src="./images/logo01edu.svg" alt="01Edu Logo" />',
                        '</td>',
                      '</tr>',

                      '<tr>',
                        '<td class="social">',
                          '<table cellpadding="0" cellspacing="0" border="0" style="width: auto; border-collapse: collapse; margin: 0 auto;">',
                            '<tr>',
                              '<td><a href="https://www.linkedin.com/company/01edu/"><img src="./images/linkedin.svg" alt="LinkedIn" /></a></td>',
                              '<td><a href="https://www.youtube.com/@01Edu_ai"><img src="./images/youtube.svg" alt="YouTube" /></a></td>',
                              '<td><a href="https://www.instagram.com/01edu_ai/"><img src="./images/instagram.svg" alt="Instagram" /></a></td>',
                            '</tr>',
                          '</table>',
